!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Mark=t()}(this,function(){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=(e(c,[{key:"getContexts",value:function(){var r=[];return(void 0!==this.ctx&&this.ctx?NodeList.prototype.isPrototypeOf(this.ctx)?Array.prototype.slice.call(this.ctx):Array.isArray(this.ctx)?this.ctx:"string"==typeof this.ctx?Array.prototype.slice.call(document.querySelectorAll(this.ctx)):[this.ctx]:[]).forEach(function(t){var e=0<r.filter(function(e){return e.contains(t)}).length;-1!==r.indexOf(t)||e||r.push(t)}),r}},{key:"getIframeContents",value:function(e,t,r){var r=2<arguments.length&&void 0!==r?r:function(){},n=void 0;try{var i=e.contentWindow,n=i.document;if(!i||!n)throw new Error("iframe inaccessible")}catch(e){r()}n&&t(n)}},{key:"isIframeBlank",value:function(e){var t="about:blank",r=e.getAttribute("src").trim();return e.contentWindow.location.href===t&&r!==t&&r}},{key:"observeIframeLoad",value:function(e,t,r){function n(){if(!o){o=!0,clearTimeout(a);try{i.isIframeBlank(e)||(e.removeEventListener("load",n),i.getIframeContents(e,t,r))}catch(e){r()}}}var i=this,o=!1,a=null;e.addEventListener("load",n),a=setTimeout(n,this.iframesTimeout)}},{key:"onIframeReady",value:function(e,t,r){try{"complete"!==e.contentWindow.document.readyState||this.isIframeBlank(e)?this.observeIframeLoad(e,t,r):this.getIframeContents(e,t,r)}catch(e){r()}}},{key:"waitForIframes",value:function(e,t){var r=this,n=0;this.forEachIframe(e,function(){return!0},function(e){n++,r.waitForIframes(e.querySelector("html"),function(){--n||t()})},function(e){e||t()})}},{key:"forEachIframe",value:function(e,r,n,t){function i(){--l<=0&&a(s)}var o=this,a=3<arguments.length&&void 0!==t?t:function(){},l=(e=e.querySelectorAll("iframe")).length,s=0,e=Array.prototype.slice.call(e);l||i(),e.forEach(function(t){c.matches(t,o.exclude)?i():o.onIframeReady(t,function(e){r(t)&&(s++,n(e)),i()},i)})}},{key:"createIterator",value:function(e,t,r){return document.createNodeIterator(e,t,r,!1)}},{key:"createInstanceOnIframe",value:function(e){return new c(e.querySelector("html"),this.iframes)}},{key:"compareNodeIframe",value:function(e,t,r){if(e.compareDocumentPosition(r)&Node.DOCUMENT_POSITION_PRECEDING){if(null===t)return!0;if(t.compareDocumentPosition(r)&Node.DOCUMENT_POSITION_FOLLOWING)return!0}return!1}},{key:"getIteratorNode",value:function(e){var t=e.previousNode();return{prevNode:t,node:(null===t||e.nextNode())&&e.nextNode()}}},{key:"checkIframeFilter",value:function(e,t,r,n){var i=!1,o=!1;return n.forEach(function(e,t){e.val===r&&(i=t,o=e.handled)}),this.compareNodeIframe(e,t,r)?(!1!==i||o?!1===i||o||(n[i].handled=!0):n.push({val:r,handled:!0}),!0):(!1===i&&n.push({val:r,handled:!1}),!1)}},{key:"handleOpenIframes",value:function(e,t,r,n){var i=this;e.forEach(function(e){e.handled||i.getIframeContents(e.val,function(e){i.createInstanceOnIframe(e).forEachNode(t,r,n)})})}},{key:"iterateThroughNodes",value:function(t,e,r,n,i){for(var o,a=this,l=this.createIterator(e,t,n),s=[],c=[],u=void 0,f=void 0;o=void 0,o=a.getIteratorNode(l),f=o.prevNode,u=o.node;)this.iframes&&this.forEachIframe(e,function(e){return a.checkIframeFilter(u,f,e,s)},function(e){a.createInstanceOnIframe(e).forEachNode(t,function(e){return c.push(e)},n)}),c.push(u);c.forEach(function(e){r(e)}),this.iframes&&this.handleOpenIframes(s,t,r,n),i()}},{key:"forEachNode",value:function(r,n,i,e){var o=this,a=3<arguments.length&&void 0!==e?e:function(){},e=this.getContexts(),l=e.length;l||a(),e.forEach(function(e){function t(){o.iterateThroughNodes(r,e,n,i,function(){--l<=0&&a()})}o.iframes?o.waitForIframes(e,t):t()})}}],[{key:"matches",value:function(t,e){var e="string"==typeof e?[e]:e,r=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;if(r){var n=!1;return e.every(function(e){return!r.call(t,e)||!(n=!0)}),n}return!1}}]),c);function c(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:5e3;i(this,c),this.ctx=e,this.iframes=t,this.exclude=r,this.iframesTimeout=n}var l=(e(r,[{key:"log",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"debug",r=this.opt.log;this.opt.debug&&"object"===(void 0===r?"undefined":n(r))&&"function"==typeof r[t]&&r[t]("mark.js: "+e)}},{key:"escapeStr",value:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}},{key:"createRegExp",value:function(e){return"disabled"!==this.opt.wildcards&&(e=this.setupWildcardsRegExp(e)),e=this.escapeStr(e),Object.keys(this.opt.synonyms).length&&(e=this.createSynonymsRegExp(e)),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),this.opt.diacritics&&(e=this.createDiacriticsRegExp(e)),e=this.createMergedBlanksRegExp(e),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.createJoinersRegExp(e)),"disabled"!==this.opt.wildcards&&(e=this.createWildcardsRegExp(e)),e=this.createAccuracyRegExp(e)}},{key:"createSynonymsRegExp",value:function(e){var t,r,n,i=this.opt.synonyms,o=this.opt.caseSensitive?"":"i",a=this.opt.ignoreJoiners||this.opt.ignorePunctuation.length?"\0":"";for(t in i)i.hasOwnProperty(t)&&(n=i[t],r="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(t):this.escapeStr(t),n="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(n):this.escapeStr(n),""!==r&&""!==n&&(e=e.replace(new RegExp("("+this.escapeStr(r)+"|"+this.escapeStr(n)+")","gm"+o),a+"("+this.processSynomyms(r)+"|"+this.processSynomyms(n)+")"+a)));return e}},{key:"processSynomyms",value:function(e){return(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),e}},{key:"setupWildcardsRegExp",value:function(e){return(e=e.replace(/(?:\\)*\?/g,function(e){return"\\"===e.charAt(0)?"?":""})).replace(/(?:\\)*\*/g,function(e){return"\\"===e.charAt(0)?"*":""})}},{key:"createWildcardsRegExp",value:function(e){var t="withSpaces"===this.opt.wildcards;return e.replace(/\u0001/g,t?"[\\S\\s]?":"\\S?").replace(/\u0002/g,t?"[\\S\\s]*?":"\\S*")}},{key:"setupIgnoreJoinersRegExp",value:function(e){return e.replace(/[^(|)\\]/g,function(e,t,r){t=r.charAt(t+1);return/[(|)\\]/.test(t)||""===t?e:e+"\0"})}},{key:"createJoinersRegExp",value:function(e){var t=[],r=this.opt.ignorePunctuation;return Array.isArray(r)&&r.length&&t.push(this.escapeStr(r.join(""))),this.opt.ignoreJoiners&&t.push("\\u00ad\\u200b\\u200c\\u200d"),t.length?e.split(/\u0000+/).join("["+t.join("")+"]*"):e}},{key:"createDiacriticsRegExp",value:function(r){var n=this.opt.caseSensitive?"":"i",e=this.opt.caseSensitive?["aàáảãạăằắẳẵặâầấẩẫậäåāą","AÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćč","CÇĆČ","dđď","DĐĎ","eèéẻẽẹêềếểễệëěēę","EÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïī","IÌÍỈĨỊÎÏĪ","lł","LŁ","nñňń","NÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøō","OÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rř","RŘ","sšśșş","SŠŚȘŞ","tťțţ","TŤȚŢ","uùúủũụưừứửữựûüůū","UÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿ","YÝỲỶỸỴŸ","zžżź","ZŽŻŹ"]:["aàáảãạăằắẳẵặâầấẩẫậäåāąAÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćčCÇĆČ","dđďDĐĎ","eèéẻẽẹêềếểễệëěēęEÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïīIÌÍỈĨỊÎÏĪ","lłLŁ","nñňńNÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøōOÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rřRŘ","sšśșşSŠŚȘŞ","tťțţTŤȚŢ","uùúủũụưừứửữựûüůūUÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿYÝỲỶỸỴŸ","zžżźZŽŻŹ"],i=[];return r.split("").forEach(function(t){e.every(function(e){if(-1!==e.indexOf(t)){if(-1<i.indexOf(e))return!1;r=r.replace(new RegExp("["+e+"]","gm"+n),"["+e+"]"),i.push(e)}return!0})}),r}},{key:"createMergedBlanksRegExp",value:function(e){return e.replace(/[\s]+/gim,"[\\s]+")}},{key:"createAccuracyRegExp",value:function(e){var t=this,r=this.opt.accuracy,n="string"==typeof r?r:r.value,r="string"==typeof r?[]:r.limiters,i="";switch(r.forEach(function(e){i+="|"+t.escapeStr(e)}),n){case"partially":default:return"()("+e+")";case"complementary":return"()([^"+(i="\\s"+(i||this.escapeStr("!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~¡¿")))+"]*"+e+"[^"+i+"]*)";case"exactly":return"(^|\\s"+i+")("+e+")(?=$|\\s"+i+")"}}},{key:"getSeparatedKeywords",value:function(e){var t=this,r=[];return e.forEach(function(e){t.opt.separateWordSearch?e.split(" ").forEach(function(e){e.trim()&&-1===r.indexOf(e)&&r.push(e)}):e.trim()&&-1===r.indexOf(e)&&r.push(e)}),{keywords:r.sort(function(e,t){return t.length-e.length}),length:r.length}}},{key:"isNumeric",value:function(e){return Number(parseFloat(e))==e}},{key:"checkRanges",value:function(e){var i=this;if(!Array.isArray(e)||"[object Object]"!==Object.prototype.toString.call(e[0]))return this.log("markRanges() will only accept an array of objects"),this.opt.noMatch(e),[];var o=[],a=0;return e.sort(function(e,t){return e.start-t.start}).forEach(function(e){var t=i.callNoMatchOnInvalidRanges(e,a),r=t.start,n=t.end;t.valid&&(e.start=r,e.length=n-r,o.push(e),a=n)}),o}},{key:"callNoMatchOnInvalidRanges",value:function(e,t){var r=void 0,n=void 0,i=!1;return e&&void 0!==e.start?(n=(r=parseInt(e.start,10))+parseInt(e.length,10),this.isNumeric(e.start)&&this.isNumeric(e.length)&&0<n-t&&0<n-r?i=!0:(this.log("Ignoring invalid or overlapping range: "+JSON.stringify(e)),this.opt.noMatch(e))):(this.log("Ignoring invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:r,end:n,valid:i}}},{key:"checkWhitespaceRanges",value:function(e,t,r){var n=void 0,i=!0,o=r.length,t=t-o,t=parseInt(e.start,10)-t;return o<(n=(t=o<t?o:t)+parseInt(e.length,10))&&(n=o,this.log("End range automatically set to the max value of "+o)),t<0||n-t<0||o<t||o<n?(i=!1,this.log("Invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)):""===r.substring(t,n).replace(/\s+/g,"")&&(i=!1,this.log("Skipping whitespace only range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:t,end:n,valid:i}}},{key:"getTextNodes",value:function(e){var t=this,r="",n=[];this.iterator.forEachNode(NodeFilter.SHOW_TEXT,function(e){n.push({start:r.length,end:(r+=e.textContent).length,node:e})},function(e){return t.matchesExclude(e.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},function(){e({value:r,nodes:n})})}},{key:"matchesExclude",value:function(e){return a.matches(e,this.opt.exclude.concat(["script","style","title","head","html"]))}},{key:"wrapRangeInTextNode",value:function(e,t,r){var n=this.opt.element||"mark",e=e.splitText(t),t=e.splitText(r-t),n=document.createElement(n);return n.setAttribute("data-markjs","true"),this.opt.className&&n.setAttribute("class",this.opt.className),n.textContent=e.textContent,e.parentNode.replaceChild(n,e),t}},{key:"wrapRangeInMappedTextNode",value:function(a,l,s,c,u){var f=this;a.nodes.every(function(e,r){var t=a.nodes[r+1];if(void 0===t||t.start>l){if(!c(e.node))return!1;var n=l-e.start,i=(s>e.end?e.end:s)-e.start,o=a.value.substr(0,e.start),t=a.value.substr(i+e.start);if(e.node=f.wrapRangeInTextNode(e.node,n,i),a.value=o+t,a.nodes.forEach(function(e,t){r<=t&&(0<a.nodes[t].start&&t!==r&&(a.nodes[t].start-=i),a.nodes[t].end-=i)}),s-=i,u(e.node.previousSibling,e.start),!(s>e.end))return!1;l=e.end}return!0})}},{key:"wrapMatches",value:function(i,e,o,a,t){var l=this,s=0===e?0:e+1;this.getTextNodes(function(e){e.nodes.forEach(function(e){e=e.node;for(var t;null!==(t=i.exec(e.textContent))&&""!==t[s];)if(o(t[s],e)){var r=t.index;if(0!==s)for(var n=1;n<s;n++)r+=t[n].length;e=l.wrapRangeInTextNode(e,r,r+t[s].length),a(e.previousSibling),i.lastIndex=0}}),t()})}},{key:"wrapMatchesAcrossElements",value:function(o,e,a,l,s){var c=this,u=0===e?0:e+1;this.getTextNodes(function(e){for(var t;null!==(t=o.exec(e.value))&&""!==t[u];){var r=t.index;if(0!==u)for(var n=1;n<u;n++)r+=t[n].length;var i=r+t[u].length;c.wrapRangeInMappedTextNode(e,r,i,function(e){return a(t[u],e)},function(e,t){o.lastIndex=t,l(e)})}s()})}},{key:"wrapRangeFromIndex",value:function(e,l,s,t){var c=this;this.getTextNodes(function(o){var a=o.value.length;e.forEach(function(t,r){var e=c.checkWhitespaceRanges(t,a,o.value),n=e.start,i=e.end;e.valid&&c.wrapRangeInMappedTextNode(o,n,i,function(e){return l(e,t,o.value.substring(n,i),r)},function(e){s(e,t)})}),t()})}},{key:"unwrapMatches",value:function(e){for(var t=e.parentNode,r=document.createDocumentFragment();e.firstChild;)r.appendChild(e.removeChild(e.firstChild));t.replaceChild(r,e),this.ie?this.normalizeTextNode(t):t.normalize()}},{key:"normalizeTextNode",value:function(e){if(e){if(3===e.nodeType)for(;e.nextSibling&&3===e.nextSibling.nodeType;)e.nodeValue+=e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);else this.normalizeTextNode(e.firstChild);this.normalizeTextNode(e.nextSibling)}}},{key:"markRegExp",value:function(e,t){var r=this;this.opt=t,this.log('Searching with expression "'+e+'"');var n=0,t="wrapMatches";this.opt.acrossElements&&(t="wrapMatchesAcrossElements"),this[t](e,this.opt.ignoreGroups,function(e,t){return r.opt.filter(t,e,n)},function(e){n++,r.opt.each(e)},function(){0===n&&r.opt.noMatch(e),r.opt.done(n)})}},{key:"mark",value:function(e,t){var i=this;this.opt=t;var o=0,a="wrapMatches",e=this.getSeparatedKeywords("string"==typeof e?[e]:e),l=e.keywords,s=e.length,c=this.opt.caseSensitive?"":"i",e=function e(r){var t=new RegExp(i.createRegExp(r),"gm"+c),n=0;i.log('Searching with expression "'+t+'"'),i[a](t,1,function(e,t){return i.opt.filter(t,r,o,n)},function(e){n++,o++,i.opt.each(e)},function(){0===n&&i.opt.noMatch(r),l[s-1]===r?i.opt.done(o):e(l[l.indexOf(r)+1])})};this.opt.acrossElements&&(a="wrapMatchesAcrossElements"),0===s?this.opt.done(o):e(l[0])}},{key:"markRanges",value:function(e,t){var i=this;this.opt=t;var r=0,e=this.checkRanges(e);e&&e.length?(this.log("Starting to mark with the following ranges: "+JSON.stringify(e)),this.wrapRangeFromIndex(e,function(e,t,r,n){return i.opt.filter(e,t,r,n)},function(e,t){r++,i.opt.each(e,t)},function(){i.opt.done(r)})):this.opt.done(r)}},{key:"unmark",value:function(e){var r=this;this.opt=e;var n=this.opt.element||"*";n+="[data-markjs]",this.opt.className&&(n+="."+this.opt.className),this.log('Removal selector "'+n+'"'),this.iterator.forEachNode(NodeFilter.SHOW_ELEMENT,function(e){r.unwrapMatches(e)},function(e){var t=a.matches(e,n),e=r.matchesExclude(e);return!t||e?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},this.opt.done)}},{key:"opt",set:function(e){this._opt=t({},{element:"",className:"",exclude:[],iframes:!1,iframesTimeout:5e3,separateWordSearch:!0,diacritics:!0,synonyms:{},accuracy:"partially",acrossElements:!1,caseSensitive:!1,ignoreJoiners:!1,ignoreGroups:0,ignorePunctuation:[],wildcards:"disabled",each:function(){},noMatch:function(){},filter:function(){return!0},done:function(){},debug:!1,log:window.console},e)},get:function(){return this._opt}},{key:"iterator",get:function(){return new a(this.ctx,this.opt.iframes,this.opt.exclude,this.opt.iframesTimeout)}}]),r);function r(e){i(this,r),this.ctx=e,this.ie=!1;e=window.navigator.userAgent;(-1<e.indexOf("MSIE")||-1<e.indexOf("Trident"))&&(this.ie=!0)}return function(e){var r=this,n=new l(e);return this.mark=function(e,t){return n.mark(e,t),r},this.markRegExp=function(e,t){return n.markRegExp(e,t),r},this.markRanges=function(e,t){return n.markRanges(e,t),r},this.unmark=function(e){return n.unmark(e),r},this}}),function(){function f(e,t){for(var r,n=e&&e.options,i=0,o=n.length;i<o;i++)r=n[i],-1!==t.indexOf(r.value)?r.selected=!0:r.selected=!1;return 1}function h(e,t){return t=void 0!==t?t:window.location.href,e=e.replace(/[\[\]]/g,"\\$&"),(t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t))?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null}function d(e){els=e.querySelectorAll("[filterable_preset]"),Array.prototype.forEach.call(els,function(e,t){var r=e.tagName.toLowerCase();"select"==r?f(e,[]):"input"!=r||"checkbox"!=e.getAttribute("type")&&"radio"!=e.getAttribute("type")||(e.checked=!1)})}function p(t,r){setTimeout(function(){var e=document.createEvent("Event");e.initEvent(r,!0,!1),t.dispatchEvent(e)},1)}var e,g={markjs_error_raised:!1,filterable_index_names:[],init:function(){var e=document.querySelectorAll("[filterable_group]");Array.prototype.forEach.call(e,function(i,e){i.items=i.querySelectorAll("[filterable_item]");var t=i.getAttribute("filterable_remove");""!==t&&(r=document.querySelectorAll(t),Array.prototype.forEach.call(r,function(e,t){e.remove()}));var o,r,n,a,l,s,c=i.querySelector("[filterable_form_template]"),u=!1;c&&(o=c.innerHTML,(t=i.getAttribute("filterable_replace"))?(r=document.querySelector(t),(t=document.createElement("div")).id="filterable_form_"+e,t.innerHTML=o,r.parentNode.replaceChild(t,r)&&(u=t.id)):(c.insertAdjacentHTML("afterend",o),u=!0)),u&&(g.generateIndex(i),c=i.querySelector("[filterable_empty_list_template]"),n=c?c.innerHTML:((s=document.createElement("p")).textContent="No matches found.",s.setAttribute("filterable_empty_list_message",""),s.setAttribute("hidden",""),s.outerHTML),s=i.querySelectorAll("[filterable_list]"),Array.prototype.forEach.call(s,function(e,t){e.insertAdjacentHTML("afterend",n)}),(o="string"==typeof u?document.querySelector("#"+u):i)?((a=o.querySelector("[filterable_input]")).value=window.sessionStorage.getItem(a.id),(s=h(a.id))&&(a.value=s),p(a,"change"),(l=o.querySelector("[filterable_submit]"))?l.addEventListener("click",function(e){return e.preventDefault(),window.sessionStorage.setItem(a.id,a.value),g.filterList(i,a.value),!1}):a.addEventListener("keyup",function(e){window.sessionStorage.setItem(a.id,this.value),g.filterList(i,this.value)}),0<(u=o.querySelectorAll("[filterable_toggle]")).length&&(s=i.querySelector("[filterable_item]").querySelectorAll("[filterable_index_name]"),g.filterable_index_names=Array.prototype.map.call(s,function(e){return e.getAttribute("filterable_index_name")}),Array.prototype.forEach.call(u,function(e,t){var r=e.tagName.toLowerCase(),n=(n=e.type)&&n.toLowerCase();("select"===r||"input"===r&&-1<["checkbox","radio"].indexOf(n))&&(-1<g.filterable_index_names.indexOf(e.getAttribute("filterable_toggle"))||""===e.getAttribute("filterable_toggle"))&&(e.addEventListener("change",function(e){g.toggle_index(i,this.getAttribute("filterable_toggle")),g.generateIndex(i),g.filterList(i,a.value),window.sessionStorage.setItem(a.id+".filterable_toggle",this.getAttribute("filterable_toggle"))}),r=window.sessionStorage.getItem(a.id+".filterable_toggle"),(n=h(a.id+".filterable_toggle"))&&(r=n),r&&r==e.getAttribute("filterable_toggle")&&e.click())})),g.update_exclusions(i,o),0<(u=o.querySelectorAll("[filterable_exclude_container][filterable_exclude_match]")).length&&Array.prototype.forEach.call(u,function(e,t){var r=e.tagName.toLowerCase(),n=(n=e.type)&&n.toLowerCase();"input"===r&&-1<["checkbox"].indexOf(n)&&e.addEventListener("change",function(e){g.update_exclusions(i,o)})}),(u=o.querySelector("[filterable_reset]"))&&u.addEventListener("click",function(e){setTimeout(function(){window.sessionStorage.removeItem(a.id),window.sessionStorage.removeItem(a.id+".filterable_toggle");var r=document.createEvent("HTMLEvents");r.initEvent("change",!0,!1);var e=o.querySelectorAll("select[filterable_toggle]");Array.prototype.forEach.call(e,function(e,t){e.dispatchEvent(r)});e=o.querySelectorAll("[filterable_toggle]:checked");Array.prototype.forEach.call(e,function(e,t){e.dispatchEvent(r)}),g.filterList(i,"")},1)}),window.setTimeout(function(){g.trigger_filter(l,a)},100),0<(u=o.querySelectorAll("[filterable_preset]")).length&&Array.prototype.forEach.call(u,function(i,e){var t,r;i.addEventListener("change",function(e){e.preventDefault();var r,t=e.target,n=i.tagName.toLowerCase();"select"==n?(e=function(e){for(var t,r=[],n=e&&e.options,i=0,o=n.length;i<o;i++)(t=n[i]).selected&&r.push(t.value||t.text);return r}(t),d(t.form),f(t,e),a.value=e.join("|")):"input"==n&&"checkbox"==t.getAttribute("type")?(r=[],n=t.getAttribute("name"),n=o.querySelectorAll('input[name="'+n+'"]:checked'),Array.prototype.forEach.call(n,function(e,t){r.push(e.value)}),d(t.form),Array.prototype.forEach.call(n,function(e,t){-1!==r.indexOf(e.value)&&(e.checked=!0)}),a.value=r.join("|")):a.value=t.value,p(a,"change"),window.sessionStorage.setItem(a.preset_origin,t.name),g.trigger_filter(l,a)}),window.sessionStorage.getItem(a.preset_origin)==i.name&&(t=a.value.split("|"),"select"==(r=i.tagName.toLowerCase())?f(i,t):"input"==r&&"checkbox"==i.getAttribute("type")&&-1!==t.indexOf(i.value)&&(i.checked=!0))})):console.error("Could not find form."))})},trigger_filter:function(e,t){if(e)e.click();else{var r;try{r=new KeyboardEvent("keyup",{key:"13",bubbles:!0})}catch(e){(r=document.createEvent("KeyboardEvent")).initKeyboardEvent("keyup",!1,!1,null,"13",0,"",!1,"")}t.dispatchEvent(r)}},update_exclusions:function(n,e){n.exclusions={length:0,keys:[]};var t=e.querySelectorAll("[filterable_exclude_container][filterable_exclude_match]");0<t.length&&(Array.prototype.forEach.call(t,function(e,t){var r;e.checked||(r=e.getAttribute("filterable_exclude_container"),void 0===n.exclusions[r]&&(n.exclusions[r]=[]),n.exclusions[r].push(e.getAttribute("filterable_exclude_match")),n.exclusions.length++,n.exclusions.keys.push(r))}),e=e.querySelector("[filterable_input]"),g.filterList(n,e.value))},generateIndex:function(e){var n,e=e.items;Array.prototype.forEach.call(e,function(e,t){var r;""===e.getAttribute("filterable_index")?n=e.textContent:(r=e.querySelectorAll("[filterable_index]"),n="",Array.prototype.forEach.call(r,function(e,t){n+=e.textContent+" "})),n=(n=n.toLowerCase().trim()).replace(/\s{2,}/g,""),e.setAttribute("filterable_index_string",n)})},filterList:function(o,a){a=a.toLowerCase().trim();var e=o.items,l="odd";Array.prototype.forEach.call(e,function(n,e){var t,r,i=!1;o.exclusions&&0<o.exclusions.length&&Array.prototype.forEach.call(o.exclusions.keys,function(r){Array.prototype.forEach.call(o.exclusions[r],function(e){var t=new RegExp(e),e=n.querySelector(r);null!==t.exec(e.innerHTML)&&(i=!0)})}),n.removeAttribute("hidden"),n.removeAttribute("filterable_visible_item"),i?n.setAttribute("hidden",""):(a=(a=a.replace(" |","|")).replace("| ","|"),t=new RegExp("("+a+")","g"),r=n.getAttribute("filterable_index_string"),t.test(r)?(n.removeAttribute("hidden"),n.setAttribute("filterable_visible_item",l),l="odd"==l?"even":"odd",""===o.getAttribute("filterable_mark_results")&&g.debounce(g.highlight_results(n,t,r),250)):n.setAttribute("hidden",""))}),g.checkListEmpty(o)},checkListEmpty:function(e){e=e.querySelectorAll("[filterable_list]");Array.prototype.forEach.call(e,function(e,t){var r=e.querySelectorAll("[filterable_item]:not([hidden])").length,n=!r,i=e.nextElementSibling;e.setAttribute("filterable_visibile_items",r),n?(e.setAttribute("hidden",""),i.removeAttribute("hidden")):(e.removeAttribute("hidden"),i.setAttribute("hidden",""))})},toggle_index:function(e,r){e=e.querySelectorAll("[filterable_index_name]");Array.prototype.forEach.call(e,function(e,t){e.getAttribute("filterable_index_name")===r||""===r?e.setAttribute("filterable_index",""):e.removeAttribute("filterable_index")})},highlight_results:function(e,t,r){var n;window.Mark?(n=new Mark(e.querySelectorAll("[filterable_index], [filterable_index_name]"))).unmark({done:function(){var e=r.match(t);Array.prototype.forEach.call(e,function(e,t){n.mark(e)})}}):g.markjs_error_raised||(console.error("Mark.js isn't loaded - could not highlight query results."),g.markjs_error_raised=!0)},closest:function(e,t,r){for(var n=null;e;){if(e.matches(t)){n=e;break}if(r&&e.matches(r))break;e=e.parentElement}return n},debounce:function(n,i,o){var a;return function(){var e=this,t=arguments,r=o&&!a;clearTimeout(a),a=setTimeout(function(){a=null,o||n.apply(e,t)},i),r&&n.apply(e,t)}}};e=g.init,(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?e():document.addEventListener("DOMContentLoaded",e)}();